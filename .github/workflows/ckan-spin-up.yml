on: push

name: ckan-spin-up

jobs:
  ckan-spin-up:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Clone ckan docker repo
        run: |
          git config --global user.email "myrmecocystus@gmail.com"
          git config --global user.name "myrmecocystus"
          git clone https://github.com/okfn/docker-ckan.git
      - name: Spin up ckan
        run: |
          cd docker-ckan
          cp .env.example .env
          docker-compose build
          docker-compose up -d
          curl --retry 5 --retry-delay 1  localhost:5000/api/3

      # - name: Check if CKAN is up
      #   run: |
      #     curl --retry 5 --retry-delay 1  localhost:5000/api/3
